[{"name":"app.R","content":"library(shiny)\r\nlibrary(MASS)\r\n\r\nui <- fluidPage(\r\n  titlePanel(\"Korrelation & Punktwolke (Shinylive)\"),\r\n  \r\n  sidebarLayout(\r\n    sidebarPanel(\r\n      sliderInput(\r\n        \"rho\", \"Ziel-Korrelation r\",\r\n        min = -0.9, max = 0.9,\r\n        value = 0.6, step = 0.1\r\n      ),\r\n      sliderInput(\r\n        \"n\", \"Stichprobengröße n\",\r\n        min = 20, max = 1000,\r\n        value = 200, step = 20\r\n      ),\r\n      checkboxInput(\"showLine\", \"Regressionslinie anzeigen\", TRUE),\r\n      actionButton(\"resample\", \"Neue Stichprobe ziehen\")\r\n    ),\r\n    \r\n    mainPanel(\r\n      plotOutput(\"scatter\"),\r\n      verbatimTextOutput(\"corVal\")\r\n    )\r\n  )\r\n)\r\n\r\nserver <- function(input, output, session) {\r\n  \r\n  # Reaktive Daten, neu wenn Button gedrückt oder Parameter geändert\r\n  data <- reactive({\r\n    # Einfacher Trick für Zielkorrelation:\r\n    # x ~ N(0,1), z ~ N(0,1), y = r*x + sqrt(1-r^2)*z\r\n    set.seed(NULL)\r\n    x <- rnorm(input$n)\r\n    z <- rnorm(input$n)\r\n    r <- input$rho\r\n    y <- r * x + sqrt(1 - r^2) * z\r\n    data.frame(x = x, y = y)\r\n  })\r\n  \r\n  # Button sorgt dafür, dass Plot neu gezeichnet wird\r\n  observeEvent(input$resample, {\r\n    data()  # reaktive Quelle neu auswerten\r\n  })\r\n  \r\n  output$scatter <- renderPlot({\r\n    d <- data()\r\n    plot(\r\n      d$x, d$y,\r\n      xlab = \"X\", ylab = \"Y\",\r\n      main = paste0(\"Ziel-r = \", round(input$rho, 2))\r\n    )\r\n    if (input$showLine) {\r\n      abline(lm(y ~ x, data = d), lwd = 2)\r\n    }\r\n  })\r\n  \r\n  output$corVal <- renderPrint({\r\n    d <- data()\r\n    cat(\"Empirische Korrelation r:\", round(cor(d$x, d$y), 3))\r\n  })\r\n}\r\n\r\nshinyApp(ui, server)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","type":"text"}]
